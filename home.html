<!-- home.html -->
<script src="js/supabase-config.js"></script>
<script>
  async function checkSession() {
    const { data: { session }, error } = await supabaseClient.auth.getSession();
    if (error) {
      console.error("Session error:", error);
      return;
    }
    if (!session) return;

    const userId = session.user.id;
    const { data: profile, error: pErr } = await supabaseClient
      .from("profiles")
      .select("role")
      .eq("id", userId)
      .single();

    if (pErr) {
      console.error("Profile error:", pErr);
      return;
    }

    if (profile?.role === "admin") {
      window.location.href = "admin-dashboard.html";
    } else {
      window.location.href = "user-home.html";
    }
  }

  checkSession();
</script>
