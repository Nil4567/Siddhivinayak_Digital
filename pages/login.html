<script src="../script.js"></script>

<script>
    // CRITICAL: Check if handleLogin is loaded before trying to use it
    if (typeof handleLogin !== 'function') {
        console.error("CRITICAL ERROR: handleLogin function not found. Check if script.js is loaded correctly.");
    }
    
    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const errorMessage = document.getElementById('login-error-message');
        const loginButton = document.getElementById('login-button');
        
        errorMessage.style.display = 'none';
        loginButton.textContent = 'Logging in...';
        loginButton.disabled = true;

        try {
            // This calls the Super Admin bypass logic
            await handleLogin(username, password);
            
            // On success, handleLogin performs the redirect, so the code ends here.
            
        } catch (error) {
            // On failure
            console.error("Login failed:", error.message);
            errorMessage.textContent = error.message;
            errorMessage.style.display = 'block';
            
            loginButton.textContent = 'Log In';
            loginButton.disabled = false;
        }
    });
</script>
