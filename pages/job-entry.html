<script src="../script.js"></script>

<script>
  checkLogin();

  function genId() {
    return 'J-' + Date.now().toString().slice(-6);
  }

  document.getElementById("jobForm").addEventListener("submit", async function(ev) {
    ev.preventDefault();

    const job = {
      id: genId(),
      date: new Date().toISOString(),
      customer: document.getElementById('custName').value,
      contact: document.getElementById('custContact').value,
      jobType: document.getElementById('jobType').value,
      qty: Number(document.getElementById('qty').value) || 1,
      department: document.getElementById('department').value,
      urgency: document.getElementById('urgency').value,
      notes: document.getElementById('notes').value,
      status: "Pending",
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString()
    };

    // ðŸ”¥ Send to GitHub
    const ok = await saveJobToGitHub(job);

    if (ok) {
      alert("Job created and saved: " + job.id);
      window.location.href = "job-queue.html";
    } else {
      alert("Failed to save job. Check console.");
    }
  });
</script>
